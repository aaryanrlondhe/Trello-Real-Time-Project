{"ast":null,"code":"import { io } from 'socket.io-client';\nclass SocketService {\n  constructor() {\n    this.socket = null;\n    this.isConnected = false;\n    this.listeners = new Map();\n    this.currentBoardId = null;\n  }\n  connect(serverUrl = process.env.REACT_APP_SOCKET_URL || 'http://localhost:5001') {\n    var _this$socket;\n    if ((_this$socket = this.socket) !== null && _this$socket !== void 0 && _this$socket.connected) {\n      console.log('Socket already connected');\n      return;\n    }\n    try {\n      this.socket = io(serverUrl, {\n        transports: ['websocket', 'polling'],\n        timeout: 20000,\n        forceNew: true\n      });\n      this.setupEventListeners();\n      console.log('Socket connection initiated to:', serverUrl);\n    } catch (error) {\n      console.error('Socket connection error:', error);\n    }\n  }\n  setupEventListeners() {\n    if (!this.socket) return;\n    this.socket.on('connect', () => {\n      console.log('Socket connected:', this.socket.id);\n      this.isConnected = true;\n      this.emit('connection-status', {\n        connected: true,\n        socketId: this.socket.id\n      });\n\n      // Rejoin current board if we were already on one\n      if (this.currentBoardId) {\n        this.joinBoard(this.currentBoardId);\n      }\n    });\n    this.socket.on('disconnect', reason => {\n      console.log('Socket disconnected:', reason);\n      this.isConnected = false;\n      this.emit('connection-status', {\n        connected: false,\n        reason\n      });\n    });\n    this.socket.on('connect_error', error => {\n      console.error('Socket connection error:', error);\n      this.emit('connection-error', {\n        error: error.message\n      });\n    });\n\n    // Real-time event listeners\n    this.socket.on('card-created', data => {\n      console.log('Card created event:', data);\n      this.emit('card-created', data);\n    });\n    this.socket.on('card-updated', data => {\n      console.log('Card updated event:', data);\n      this.emit('card-updated', data);\n    });\n    this.socket.on('card-deleted', data => {\n      console.log('Card deleted event:', data);\n      this.emit('card-deleted', data);\n    });\n    this.socket.on('board-created', data => {\n      console.log('Board created event:', data);\n      this.emit('board-created', data);\n    });\n    this.socket.on('trello-event', data => {\n      console.log('Trello event received:', data);\n      this.emit('trello-event', data);\n    });\n    this.socket.on('trello-webhook', data => {\n      console.log('Trello webhook event:', data);\n      this.emit('trello-webhook', data);\n    });\n  }\n  disconnect() {\n    if (this.socket) {\n      this.socket.disconnect();\n      this.socket = null;\n      this.isConnected = false;\n      this.currentBoardId = null;\n      console.log('Socket disconnected manually');\n    }\n  }\n  joinBoard(boardId) {\n    if (!this.socket || !boardId) {\n      console.warn('Cannot join board: socket not connected or invalid board ID');\n      return;\n    }\n\n    // Leave current board first\n    if (this.currentBoardId && this.currentBoardId !== boardId) {\n      this.leaveBoard(this.currentBoardId);\n    }\n    this.socket.emit('join-board', boardId);\n    this.currentBoardId = boardId;\n    console.log(`Joined board: ${boardId}`);\n  }\n  leaveBoard(boardId) {\n    if (!this.socket || !boardId) {\n      console.warn('Cannot leave board: socket not connected or invalid board ID');\n      return;\n    }\n    this.socket.emit('leave-board', boardId);\n    if (this.currentBoardId === boardId) {\n      this.currentBoardId = null;\n    }\n    console.log(`Left board: ${boardId}`);\n  }\n\n  // Event listener management\n  on(event, callback) {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, []);\n    }\n    this.listeners.get(event).push(callback);\n  }\n  off(event, callback) {\n    if (!this.listeners.has(event)) return;\n    const eventListeners = this.listeners.get(event);\n    const index = eventListeners.indexOf(callback);\n    if (index > -1) {\n      eventListeners.splice(index, 1);\n    }\n  }\n  emit(event, data) {\n    if (!this.listeners.has(event)) return;\n    this.listeners.get(event).forEach(callback => {\n      try {\n        callback(data);\n      } catch (error) {\n        console.error(`Error in event listener for ${event}:`, error);\n      }\n    });\n  }\n\n  // Utility methods\n  getConnectionStatus() {\n    var _this$socket2;\n    return {\n      isConnected: this.isConnected,\n      socketId: ((_this$socket2 = this.socket) === null || _this$socket2 === void 0 ? void 0 : _this$socket2.id) || null,\n      currentBoard: this.currentBoardId\n    };\n  }\n  isSocketConnected() {\n    var _this$socket3;\n    return ((_this$socket3 = this.socket) === null || _this$socket3 === void 0 ? void 0 : _this$socket3.connected) || false;\n  }\n}\nexport default new SocketService();","map":{"version":3,"names":["io","SocketService","constructor","socket","isConnected","listeners","Map","currentBoardId","connect","serverUrl","process","env","REACT_APP_SOCKET_URL","_this$socket","connected","console","log","transports","timeout","forceNew","setupEventListeners","error","on","id","emit","socketId","joinBoard","reason","message","data","disconnect","boardId","warn","leaveBoard","event","callback","has","set","get","push","off","eventListeners","index","indexOf","splice","forEach","getConnectionStatus","_this$socket2","currentBoard","isSocketConnected","_this$socket3"],"sources":["/Users/shrushtiparkar/Documents/Trello Real-time WebSockets + API Frontend Assignment/frontend/src/services/socketService.js"],"sourcesContent":["import { io } from 'socket.io-client';\n\nclass SocketService {\n  constructor() {\n    this.socket = null;\n    this.isConnected = false;\n    this.listeners = new Map();\n    this.currentBoardId = null;\n  }\n\n  connect(serverUrl = process.env.REACT_APP_SOCKET_URL || 'http://localhost:5001') {\n    if (this.socket?.connected) {\n      console.log('Socket already connected');\n      return;\n    }\n\n    try {\n      this.socket = io(serverUrl, {\n        transports: ['websocket', 'polling'],\n        timeout: 20000,\n        forceNew: true\n      });\n\n      this.setupEventListeners();\n      console.log('Socket connection initiated to:', serverUrl);\n    } catch (error) {\n      console.error('Socket connection error:', error);\n    }\n  }\n\n  setupEventListeners() {\n    if (!this.socket) return;\n\n    this.socket.on('connect', () => {\n      console.log('Socket connected:', this.socket.id);\n      this.isConnected = true;\n      this.emit('connection-status', { connected: true, socketId: this.socket.id });\n      \n      // Rejoin current board if we were already on one\n      if (this.currentBoardId) {\n        this.joinBoard(this.currentBoardId);\n      }\n    });\n\n    this.socket.on('disconnect', (reason) => {\n      console.log('Socket disconnected:', reason);\n      this.isConnected = false;\n      this.emit('connection-status', { connected: false, reason });\n    });\n\n    this.socket.on('connect_error', (error) => {\n      console.error('Socket connection error:', error);\n      this.emit('connection-error', { error: error.message });\n    });\n\n    // Real-time event listeners\n    this.socket.on('card-created', (data) => {\n      console.log('Card created event:', data);\n      this.emit('card-created', data);\n    });\n\n    this.socket.on('card-updated', (data) => {\n      console.log('Card updated event:', data);\n      this.emit('card-updated', data);\n    });\n\n    this.socket.on('card-deleted', (data) => {\n      console.log('Card deleted event:', data);\n      this.emit('card-deleted', data);\n    });\n\n    this.socket.on('board-created', (data) => {\n      console.log('Board created event:', data);\n      this.emit('board-created', data);\n    });\n\n    this.socket.on('trello-event', (data) => {\n      console.log('Trello event received:', data);\n      this.emit('trello-event', data);\n    });\n\n    this.socket.on('trello-webhook', (data) => {\n      console.log('Trello webhook event:', data);\n      this.emit('trello-webhook', data);\n    });\n  }\n\n  disconnect() {\n    if (this.socket) {\n      this.socket.disconnect();\n      this.socket = null;\n      this.isConnected = false;\n      this.currentBoardId = null;\n      console.log('Socket disconnected manually');\n    }\n  }\n\n  joinBoard(boardId) {\n    if (!this.socket || !boardId) {\n      console.warn('Cannot join board: socket not connected or invalid board ID');\n      return;\n    }\n\n    // Leave current board first\n    if (this.currentBoardId && this.currentBoardId !== boardId) {\n      this.leaveBoard(this.currentBoardId);\n    }\n\n    this.socket.emit('join-board', boardId);\n    this.currentBoardId = boardId;\n    console.log(`Joined board: ${boardId}`);\n  }\n\n  leaveBoard(boardId) {\n    if (!this.socket || !boardId) {\n      console.warn('Cannot leave board: socket not connected or invalid board ID');\n      return;\n    }\n\n    this.socket.emit('leave-board', boardId);\n    if (this.currentBoardId === boardId) {\n      this.currentBoardId = null;\n    }\n    console.log(`Left board: ${boardId}`);\n  }\n\n  // Event listener management\n  on(event, callback) {\n    if (!this.listeners.has(event)) {\n      this.listeners.set(event, []);\n    }\n    this.listeners.get(event).push(callback);\n  }\n\n  off(event, callback) {\n    if (!this.listeners.has(event)) return;\n    \n    const eventListeners = this.listeners.get(event);\n    const index = eventListeners.indexOf(callback);\n    if (index > -1) {\n      eventListeners.splice(index, 1);\n    }\n  }\n\n  emit(event, data) {\n    if (!this.listeners.has(event)) return;\n    \n    this.listeners.get(event).forEach(callback => {\n      try {\n        callback(data);\n      } catch (error) {\n        console.error(`Error in event listener for ${event}:`, error);\n      }\n    });\n  }\n\n  // Utility methods\n  getConnectionStatus() {\n    return {\n      isConnected: this.isConnected,\n      socketId: this.socket?.id || null,\n      currentBoard: this.currentBoardId\n    };\n  }\n\n  isSocketConnected() {\n    return this.socket?.connected || false;\n  }\n}\n\nexport default new SocketService();"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}